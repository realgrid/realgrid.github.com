---
layout: tutopost
title: B7-11 Column Validation
date: 2015-11-09 14:00:00 +9:00 GMT
permalink: /tutorial/b7-11
author: fanelia@wrw.kr
categories: 
  - Tutorial
order: B007011
course:
  - B-Class
summary: RealGridJS에서 입력값 검증에 사용되는 Column Validation에 대하여 설명합니다.
tags: 
  - RealGridJS
  - RealGrid
  - Tutorial
  - Validation
  - Column Validation
  - 검증
  - 컬럼 검증
---

<script type="text/javascript" src="/script/realgridjs-lic.js"></script>
<script type="text/javascript" src="/script/realgridjs_eval.1.0.11.min.js"></script>
<script type="text/javascript" src="/script/realgridjs-api.1.0.11.js"></script>

<script language="javascript">
var gridView;
var dataProvider;

$(document).ready( function(){
    RealGridJS.setTrace(false);
    RealGridJS.setRootContext("/script");
    
    dataProvider = new RealGridJS.LocalDataProvider();
    gridView = new RealGridJS.GridView("realgrid");
    gridView.setDataSource(dataProvider);

    //필드 배열 객체를  생성합니다.
    var fields = [
        {
            fieldName: "field1"
        },
        {
            fieldName: "field2"
        },
        {
            fieldName: "field3"
        },
        {
            fieldName: "field4"
        },
        {
            fieldName: "field5"
        },
        {
            fieldName: "field6"
        },
        {
            fieldName: "field7"
        },
        {
            fieldName: "field8"
        },
        {
            fieldName: "field9"
        },
        {
            fieldName: "field10"
        }
    ];
    //DataProvider의 setFields함수로 필드를 입력합니다.
    dataProvider.setFields(fields);

    //필드와 연결된 컬럼 배열 객체를 생성합니다.
    var columns = [
        {
            name: "col1",
            fieldName: "field1",
            header : {
                text: "직업"
            },
            width : 60
        },
        {
            name: "col2",
            fieldName: "field2",
            header : {
                text: "성별"
            },
            width: 50
        },
        {
            name: "col3",
            fieldName: "field3",
            header : {
                text: "이름"
            },
            width: 80
        },
        {
            name: "col4",
            fieldName: "field4",
            header : {
                text: "국어"
            },
            width: 80
        },
        {
            name: "col5",
            fieldName: "field5",
            header : {
                text: "수학"
            },
            width: 80
        },
        {
            name: "col6",
            fieldName: "field6",
            header : {
                text: "영어"
            },
            width: 80
        },
        {
            name: "col7",
            fieldName: "field7",
            header : {
                text: "한국사"
            },
            width: 80
        },
        {
            name: "col8",
            fieldName: "field8",
            header : {
                text: "체육"
            },
            width: 80
        },
        {
            name: "col9",
            fieldName: "field9",
            header : {
                text: "과학"
            },
            width: 80
        },
        {
            name: "col10",
            fieldName: "field10",
            header : {
                text: "사회"
            },
            width: 80
        }
    ];
    //컬럼을 GridView에 입력 합니다.
    gridView.setColumns(columns);

    var data = [
        ["배우", "여자", "전도연", "100", "70", "90", "70", "60", "100", "80"],
        ["가수", "여자", "이선희", "100", "33", "90", "70", "60", "100", "80"],
        ["배우", "여자", "하지원", "100", "100", "90", "70", "60", "100", "80"],
        ["가수", "여자", "박정현", "100", "90", "90", "70", "60", "100", "80"],
        ["배우", "여자", "전지현", "100", "100", "90", "70", "60", "100", "80"],
        ["가수", "남자", "이승환", "100", "100", "100", "100", "100", "100", "100"],
        ["가수", "남자", "신해철", "100", "100", "100", "100", "100", "100", "100"],
        ["가수", "남자", "타블로", "100", "100", "100", "100", "100", "100", "100"],
        ["가수", "남자", "토이" , "100", "100", "100", "100", "100", "100", "100"]
    ];
    dataProvider.setRows(data);

    gridView.setOptions({
        indicator: {visible: true},        
        checkBar: {visible: false},
        stateBar: {visible: true},
        edit: {insertable: true, appendable: true, updatable: true, editable: true}
    });
    
    $("#btnSetValidation").click(function () {
        //이름 컬럼에 validation을 설정합니다. (level: "error")
        var validations = [{
            criteria: "value is not empty",
            message: "이름은 반드시 필요합니다.",
            mode: "always",
            level: "error"
        }];
        var column = gridView.columnByName("col3");
        column.validations = validations;
        gridView.setColumn(column);

        //국어 컬럼에 validation을 설정합니다. (level: "warning")
        validations = [{
            criteria: "value = 100",
            message: "국어 점수는 100점이어야 합니다.",
            mode: "always",
            level: "warning"
        }];
        column = gridView.columnByName("col4");
        column.validations = validations;
        gridView.setColumn(column);

        //수학 컬럼에 validation을 설정합니다. (level: "info")
        validations = [{
            criteria: "value > 60",
            message: "수학 점수는 60점 이상이어야 합니다.",
            mode: "always",
            level: "info"
        }];
        column = gridView.columnByName("col5");
        column.validations = validations;
        gridView.setColumn(column);

        //영어 컬럼에 validation을 설정합니다. 검증식이 2개(level: "info", "warning")
        validations = [{
            criteria: "value >= 30",
            message: "영어 점수는 30점 이상이어야 합니다.",
            mode: "always",
            level: "warning"
        }, {
            criteria: "value <= 80",
            message: "영어 점수는 80점 이하이어야 합니다.",
            mode: "always",
            level: "info"
        }];
        column = gridView.columnByName("col6");
        column.validations = validations;
        gridView.setColumn(column);

        //한국사 컬럼에 validation을 설정합니다. 검증식 1개에 검증 조건 2개(level: "warning")
        validations = [{
            criteria: "(value >= 30) and (value <= 80)",
            message: "한국 점수는 30점 이상, 80점 이하이어야 합니다.",
            mode: "always",
            level: "warning"
        }];
        column = gridView.columnByName("col7");
        column.validations = validations;
        gridView.setColumn(column);
    });

    //gridView.editOptions의 commitLevel을 info 로 설정합니다.
    $("#btnCommitLevelInfo").click(function () {
        gridView.setEditOptions({
            commitLevel: "info"
        });
    });

});   

</script>

### 들어가며

이번 강좌에서는 입력한 값을 검증하는 방법인 Column Validations에 대하여 알아보도록 하겠습니다.

### 이론
RealGrid는 입력된 데이터 셀의 값을 실행 시간 중 검증할 수 있는 방법을 제공하고 있습니다. 그 중 하나인 Column Validation에 대해 배워보도록 하겠습니다. Column Validation은 사용자가 값을 입력시 컬럼 셀 단위로 입력된 값을 검증합니다. 입력된 값이 검증을 통과하지 못하면 지정한 error level 에 따라 에러 아이콘이 표시되며, 이후 행 commit()전까지 검증을 통과하지 못한다면 지정한 에러 메시지가 팝업되고 commit()이 취소됩니다.  

### EditValidation
[EditValidation](/api/types/EditValidation/)은 데이터의 검증 조건과 방식을 지정할때 사용합니다. 

* `criteria` : 검증식을 설정합니다. (ex. criteria: "value > 100") 검증식은 해당 조건을 만족하지 못했을때 실패로 처리됩니다. 
* `message` : 검증에 실패했을 경우 표시될 메시지를 지정합니다.     
* `mode` : 언제 검증을 수행할 것인지를 지정합니다. [ValidationMode](/api/types/ValidationMode/)을 설정값으로 시용합니다.  
-- 'always' : 추가, 수정된 행이 Commit될 경우에 검증    
-- 'inserted' : 추가된 행이 Commit될 경우에 검증    
-- 'update' : 수정된 행이 Commit될 경우에 검증    
* `level` : 해당 검증식이 어느 정도의 에러 등급인지 지정합니다. 여기서 지정한 값은 그리드 editOptions.commitLevel에서 지정한 레벨에 따라 검증을 수행할 것인지, 무시 할 것인지 결정됩니다. [ValidationLevel](/api/types/ValidationLevel/)을 설정 값으로 사용합니다.    
-- 'error' : 에러 등급  
-- 'warning' : 경고 등급  
-- 'info' : 참고 등급  
* `description` : 해당 검증식에 대한 설명을 입력합니다. `message`가 지정되지 않으면 `description` 메시지가 출력됩니다.                     

### 관련 그리드 속성
Column Validation과 관련된 그리드 editOption 속성이 몇가지 있습니다. 해당 속성에 대해 알아보도록 하겠습니다.

* `commitLevel` : 행 편집을 완료할 수 있는 최상위 ValidationLevel을 지정합니다. 예를들어 editOptions.commitLevel을 'warning'으로 지정하면 column validation에서 지정한 검증식 중 'warning'을 이하 단계의 검증식은 무시됩니다. 기본값은 'ignore' 입니다.  
* `validateOnEdited` : true면 셀 편집이 완료될 때 컬럼 Validation을 실행합니다. 기본값은 true 입니다.  
* `validateOnExit` : true면 셀을 빠져나갈 때 컬럼 Validation을 실행합니다. 기본값은 false 입니다.  


### 실습

실습에서는 `commitLevel`에 따라 Column Validation의 검증여부를 확인하고 그리드에 어떻게 표현되는지 확인해보도록 하겠습니다.  

1. 컬럼에 validation을 설정합니다. 

    <pre class="prettyprint">
    $("#btnSetValidation").click(function () {
        //이름 컬럼에 validation을 설정합니다. (level: "error")
        var validations = [{
            criteria: "value is not empty",
            message: "이름은 반드시 필요합니다.",
            mode: "always",
            level: "error"
        }];
        var column = gridView.columnByName("col3");
        column.validations = validations;
        gridView.setColumn(column);

        //국어 컬럼에 validation을 설정합니다. (level: "warning")
        validations = [{
            criteria: "value = 100",
            message: "국어 점수는 100점이어야 합니다.",
            mode: "always",
            level: "warning"
        }];
        column = gridView.columnByName("col4");
        column.validations = validations;
        gridView.setColumn(column);

        //수학 컬럼에 validation을 설정합니다. (level: "info")
        validations = [{
            criteria: "value > 60",
            message: "수학 점수는 60점 이상이어야 합니다.",
            mode: "always",
            level: "info"
        }];
        column = gridView.columnByName("col5");
        column.validations = validations;
        gridView.setColumn(column);

        //영어 컬럼에 validation을 설정합니다. 검증식이 2개(level: "info", "warning")
        validations = [{
            criteria: "value >= 30",
            message: "영어 점수는 30점 이상이어야 합니다.",
            mode: "always",
            level: "warning"
        }, {
            criteria: "value <= 80",
            message: "영어 점수는 80점 이하이어야 합니다.",
            mode: "always",
            level: "info"
        }];
        column = gridView.columnByName("col6");
        column.validations = validations;
        gridView.setColumn(column);

        //한국사 컬럼에 validation을 설정합니다. 검증식 1개에 검증 조건 2개(level: "warning")
        validations = [{
            criteria: "(value >= 30) and (value <= 80)",
            message: "한국사 점수는 30점 이상, 80점 이하이어야 합니다.",
            mode: "always",
            level: "warning"
        }];
        column = gridView.columnByName("col7");
        column.validations = validations;
        gridView.setColumn(column);
    });</pre>       

2. gridView.editOptions의 commitLevel을 info 로 설정합니다.

    <pre class="prettyprint">
    $("#btnCommitLevelInfo").click(function () {
        gridView.setEditOptions({
            commitLevel: "info"
        });     
    });</pre>    


### 실행화면

1. <button type="button" class="btn btn-primary btn-xs" id="btnSetValidation">SetValidation</button> 각 컬럼에 Validations을 설정합니다.

2. 1행의 전도연 이름을 지우고 'Enter'키를 눌러 편집을 완료해보세요. 붉은색 x 표시가 나타납니다.

3. 붉은색 x 아이콘에 마우스 포인터를 위치해 보세요. message에 입력했던 "이름은 반드시 필요합니다." 툴팁이 표시됩니다.

4. 키보드로 아래 화살표키를 눌러 보세요(commit()). "이름은 반드시 필요합니다." alert 창이 표시됩니다.

5. 국어부터 한국사 컬럼까지 각각의 검증식을 보고 점수를 다양하게 입력해보면서 테스트 해보세요.

6. <button type="button" class="btn btn-primary btn-xs" id="btnCommitLevelInfo">commitLevel: "info"</button> gridView.editOptions의 commitLevel을 info 로 설정합니다.

7. 국어부터 한국사 컬럼까지 각각의 검증식을 보고 점수를 다양하게 입력해보면서 테스트 해보세요. 5번에서와의 차이가 무엇인지 확인해보세요. (level이 info 이하인 컬럼은 검증이 무시됩니다. #수학 컬럼은 검증이 무시됩니다. 영어 컬럼은 80점 이하일때가 무시됩니다.)

<div id="realgrid" style="width: 100%; height: 450px;"></div>
<p></p>


### 전체 소스코드

##### SCRIPT    

<pre class="prettyprint full-source-script">

&lt;link rel=&quot;stylesheet&quot; href=&quot;/css/bootstrap.css&quot;&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;/script/jquery-1.112.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;/script/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;!--realgrid--&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;/script/realgridjs_eval.1.0.11.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;/script/realgridjs-api.1.0.11.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;
var gridView;
var dataProvider;

$(document).ready( function(){
    RealGridJS.setTrace(false);
    RealGridJS.setRootContext("/script");
    
    dataProvider = new RealGridJS.LocalDataProvider();    

    gridView = new RealGridJS.GridView("realgrid");
    gridView.setDataSource(dataProvider);


    //필드 배열 객체를  생성합니다.
    var fields = [
        {
            fieldName: "field1"
        },
        {
            fieldName: "field2"
        },
        {
            fieldName: "field3"
        },
        {
            fieldName: "field4",
            dataType: "datetime",
            datetimeFormat: "yyyyMMdd"

        },
        {
            fieldName: "field5",
            dataType: "number"
        },
        {
            fieldName: "field6",
            dataType: "number"
        },
        {
            fieldName: "field7",
            dataType: "number"
        },
        {
            fieldName: "field8",
            dataType: "number"
        },
        {
            fieldName: "field9"
        }
    ];
    //DataProvider의 setFields함수로 필드를 입력합니다.
    dataProvider.setFields(fields);

    //필드와 연결된 컬럼 배열 객체를 생성합니다.
    var columns = [
        {
            name: "col1",
            fieldName: "field1",
            values: ["sing", "act"],
            labels: ["가수", "배우"],
            lookupDisplay: true,
            editor: {
                type: "dropDown"
            },           
            header: {
                text: "직업"
            },
            styles: {
                textAlignment: "center"
            },
            width: 70
        },
        {
            name: "col2",
            fieldName: "field2",
            editor: {
                type: "dropDown"
            },
            values: ["M", "F"],
            labels: ["남자", "여자"],   
            lookupDisplay: true,         
            header: {
                text: "성별"
            },
            styles: {
                textAlignment: "center"
            },
            width: 70
        },
        {
            name: "col3",
            fieldName: "field3",  
            editor: {
                type: "search",
                searchLength: 1,  
                searchDelay: 1000,
                useCtrlEnterKey: true,
                useEnterKey: true
            },         
            header: {
                text: "이름"
            },
            styles: {
                textAlignment: "center"
            },
            width: 80
        },
        {
            name: "col4",
            fieldName: "field4",
            editor: {
                type: "date"
            },
            header : {
                text: "입학일"
            },
            styles : {
                textAlignment: "center",
                datetimeFormat: "yyyy/MM/dd"
            },
            width: 90
        },
        {
            name: "col5",
            fieldName: "field5",
            editor: {
                type: "number",
                maxLength: 5
            },
            header: {
                text: "국어"
            },
            styles: {
                textAlignment: "center"
            },
            width: 50
        },
        {
            name: "col6",
            fieldName: "field6",
            editor: {
                type: "number",
                maxLength: 5,
                positiveOnly: true
            },
            header: {
                text: "수학"
            },
            styles: {
                textAlignment: "center"
            },
            width: 50
        },
        {
            name: "col7",
            fieldName: "field7",
            editor: {
                type: "number",
                maxLength: 5,
                integerOnly: true
            },            
            header: {
                text: "민법"
            },
            styles: {
                textAlignment: "center"
            },
            width: 50
        },
        {
            name: "col8",
            fieldName: "field8",
            header: {
                text: "장학금"
            },
            styles: {
                textAlignment: "far",
                numberFormat: "#,##0"
            },
            width: 70
        },
        {
            name: "col9",
            fieldName: "field9",
            editor: {
                type: "multiLine"
            },
            header: {
                text: "메모"
            },
            styles: {
                textAlignment: "near"
            },
            width: 150
        }
    ];
    //컬럼을 GridView에 입력 합니다.김
    gridView.setColumns(columns);

    var data = [
        ["act", "F", "김도연", "20000101", "70", "90", "70", "1000000", "매우\r\n우수"],
        ["sing", "F", "이선희", "20000101", "90", "90", "70", "2000000", "아주\r\n우수"],
        ["act", "F", "하지원", "20000101", "100", "90", "70", "3000000", ""],
        ["sing", "F", "박정현", "20000101", "90", "90", "70", "100000", ""],
        ["act", "F", "전지현", "20000101", "100", "90", "70", "100000", ""],
        ["sing", "M", "성시경", "20000101", "70", "100", "100", "100000", ""],
        ["sing", "M", "신해철", "20000101", "100", "90", "100", "100000", ""],
        ["sing", "F", "루시아", "20000101", "100", "100", "100", "100000", ""],
        ["sing", "M", "윤종신", "20000101", "90", "100", "80", "100000", ""],
        ["sing", "F", "이소라", "20000101", "100", "80", "100", "100000", ""],
        ["act", "F", "강소라", "20000101", "90", "100", "70", "100000", ""],
        ["sing", "M", "타블로", "20000101", "60", "100", "100", "100000", ""],
        ["sing", "M", "이승환", "20000101", "70", "90", "100", "100000", ""],
        ["sing", "M", "조규찬", "20000101", "90", "100", "90", "100000", ""]
    ];
    dataProvider.setRows(data);

    gridView.setOptions({
        header: {height: 50},
        edit: {insertable: true, appendable: true, updatable: true, editable: true, deletable: true},
        display: {rowHeight: 50}
    });

    dataProvider.setOptions({
        softDeleting: true
    })

    //부분검색시 사용하는 onEditSearch 콜백 함수를 정의 
    $("#btnSetOnEditSearch").click(function () {
        var CustomerNames = ["김도연","이선희","하지원","박정현","전지현","성시경","신해철","루시아","윤종신","이소라","강소라","타블로","이승환","조규찬"];

        gridView.onEditSearch = function (grid, index, text) {
            console.log("onEditSearch:" + index.itemIndex + "," + index.column + ", " + text);
            var items = CustomerNames.filter(function (str) {
                return str.indexOf(text) == 0;
            });
            console.log(items);
            gridView.fillEditSearchItems(index.column, text, items);
        }; 
    });


    //이름 컬럼의 searchLength 를 2로 변경합니다.
    $("#btnSetColumnProperty").click(function () {
        gridView.setColumnProperty('col3', 'editor', {searchLength: 2});
    });

});   
&lt;/script&gt;
</pre>

##### HTML

<pre class="prettyprint full-source-script">
1. 이름 컬럼에서 '이'를 입력해 봅니다. onEditSearch() 콜백함수가 정의되지 않았기 때문에 아무런 변화가 없습니다.

2. <button type="button" class="btn btn-primary btn-xs" id="btnSetOnEditSearch">onEditSearch</button> onEditSearch() 를 정의합니다.

3. 이름 컬럼에서 다시 '이'를 입력해 봅니다. '이'로 시작하는 사람들의 이름이 목록에 표시됩니다.

4. <button type="button" class="btn btn-primary btn-xs" id="btnSetColumnProperty">searchLength: 2</button> searchLength 를 2로 변경.

5. 다시 한번 이름 컬럼에 '이'를 입력해 봅니다. 이번에는 아무런 반응이 없습니다. (searchLength: 2 로 했기 때문에 두 글자이상을 입력해야 검색이 시작됩니다.)

5. '이' 다음에 '승' 을 입력하면 '이승환'이 표시되는 것을 확인하세요. 

&lt;div id=&quot;realgrid&quot; style=&quot;width: 100%; height: 250px;&quot;&gt;&lt;/div&gt;

</pre>


---
**데모 사이트**

* [Editors 데모](http://demo.realgrid.com/Demo/Editors)

---
**API 참조**

* [DataType](/api/types/DataType/)
* [CellEditor](/api/types/CellEditor/)
* [SearchCellEditor](/api/types/SearchCellEditor/)
* [GridBase.setColumnProperty()](/api/GridBase/setColumnProperty/)
