---
layout: page
title:  "Articles"
date:   2015-04-23 15:47:54
categories: asp.net
---

### 들어가며

다음 링크를 참조해서 EF에서 사용 할 수 있는 Data Annotation Attribute에 대해 정리해 봅시다.

[https://msdn.microsoft.com/en-us/data/gg193958.aspx](https://msdn.microsoft.com/en-us/data/gg193958.aspx)

### Required

RequiredAttribute

모델의 속성을 no-nullable, 즉 테이블의 필드를 not null로 설정하고 싶다면 'Required Annotation'을 사용하면 됩니다. 하지만, 데이터타입이 string이 아닌 int타입이나 DateTime타입과 같이 조금 특별한 타입의 경우에는 기본적으로 not-null로 설정됩니다. int, DateTime타입의 속성을 강제로 nullable로 설정하기 위해서는 아래 예와 같이 클래스 속성의 타입에 ?를 붙여서 nullable로 만들어 주면 됩니다.

	   public DateTime? OriginalDate { get; set; }

예외적으로, 상속클래스의 형태로 만들어진 테이블의 경우 하위 클래스의 속성들은 int, DateTime타입인 경우도 nullable로 설정 되는것 같습니다. 확실치는 않지만 경험적으로 그런것이니 정확히 알기 위해서는 좀더 확인이 필요합니다. - 아무튼 이 경우에도 테이블의 필드 속성에는 nullable로 되지만 실제 데이터를 입력할때 null값이 들어 가면 아래와 같은 오류를 만나게 됩니다. 

**중간부분에 “datetime2 데이터 형식을 datetime 데이터 형식으로 변환하는 중 값 범위를 벗어났습니다.” 부분 확인**

	{"Message":"오류가 발생했습니다.","ExceptionMessage":"An error occurred while updating the entries. See the inner exception for details.","ExceptionType":"System.Data.Entity.Infrastructure.DbUpdateException","StackTrace":"   위치: System.Data.Entity.Internal.InternalContext.SaveChanges()\r\n   위치: System.Data.Entity.Internal.LazyInternalContext.SaveChanges()\r\n   위치: System.Data.Entity.DbContext.SaveChanges()\r\n   위치: Wapi.DAL.UnitOfWork.Commit() 파일 c:\\Users\\onlydel\\Documents\\Workspace\\wapi.wrw.kr\\wapi.DAL\\Implementations\\UnitOfWork.cs:줄 28\r\n   위치: Wapi.Service.Implementations.CalendarService.CreateTask(Task task) 파일 c:\\Users\\onlydel\\Documents\\Workspace\\wapi.wrw.kr\\Wapi.Service\\Implementations\\CalendarService.cs:줄 117\r\n   위치: Wapi.Api.Controllers.CalendarsController.CreateTask(Task task) 파일 c:\\Users\\onlydel\\Documents\\Workspace\\wapi.wrw.kr\\Wapi.Api\\Controllers\\CalendarsController.cs:줄 216\r\n   위치: lambda_method(Closure , Object , Object[] )\r\n   위치: System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass10.<GetExecutor>b__9(Object instance, Object[] methodParameters)\r\n   위치: System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)\r\n   위치: System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ExecuteAsync(HttpControllerContext controllerContext, IDictionary2 arguments, CancellationToken cancellationToken)\r\n--- 예외가 throw된 이전 위치의 스택 추적 끝 ---\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter1.GetResult()\r\n   위치: System.Web.Http.Controllers.ApiControllerActionInvoker.<InvokeActionAsyncCore>d__0.MoveNext()\r\n--- 예외가 throw된 이전 위치의 스택 추적 끝 ---\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   위치: System.Web.Http.Controllers.ActionFilterResult.<ExecuteAsync>d__2.MoveNext()\r\n--- 예외가 throw된 이전 위치의 스택 추적 끝 ---\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter1.GetResult()\r\n   위치: System.Web.Http.Filters.AuthorizationFilterAttribute.<ExecuteAuthorizationFilterAsyncCore>d__2.MoveNext()\r\n--- 예외가 throw된 이전 위치의 스택 추적 끝 ---\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   위치: System.Runtime.CompilerServices.TaskAwaiter1.GetResult()\r\n   위치: System.Web.Http.Dispatcher.HttpControllerDispatcher.<SendAsync>d__1.MoveNext()","InnerException":{"Message":"오류가 발생했습니다.","ExceptionMessage":"An error occurred while updating the entries. See the inner exception for details.","ExceptionType":"System.Data.Entity.Core.UpdateException","StackTrace":"   위치: System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update()\r\n   위치: System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.<Update>b__2(UpdateTranslator ut)\r\n   위치: System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update[T](T noChangesResult, Func2 updateFunction)\r\n   위치: System.Data.Entity.Core.EntityClient.Internal.EntityAdapter.Update()\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.<SaveChangesToStore>b__35()\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.ExecuteInTransaction[T](Func1 func, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction, Boolean releaseConnectionOnSuccess)\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.SaveChangesToStore(SaveOptions options, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction)\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.<>c__DisplayClass2a.<SaveChangesInternal>b__27()\r\n   위치: System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute[TResult](Func1 operation)\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.SaveChangesInternal(SaveOptions options, Boolean executeInExistingTransaction)\r\n   위치: System.Data.Entity.Core.Objects.ObjectContext.SaveChanges(SaveOptions options)\r\n   위치: System.Data.Entity.Internal.InternalContext.SaveChanges()","InnerException":{"Message":"오류가 발생했습니다.","ExceptionMessage":"datetime2 데이터 형식을 datetime 데이터 형식으로 변환하는 중 값 범위를 벗어났습니다.\r\n문이 종료되었습니다.","ExceptionType":"System.Data.SqlClient.SqlException","StackTrace":"   위치: System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action1 wrapCloseInAction)\r\n   위치: System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   위치: System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)\r\n   위치: System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)\r\n   위치: System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()\r\n   위치: System.Data.SqlClient.SqlDataReader.get_MetaData()\r\n   위치: System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)\r\n   위치: System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds, Boolean describeParameterEncryptionRequest)\r\n   위치: System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource1 completion, Int32 timeout, Task& task, Boolean asyncWrite)\r\n   위치: System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)\r\n   위치: System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)\r\n   위치: System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)\r\n   위치: System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)\r\n   위치: System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.<Reader>b__c(DbCommand t, DbCommandInterceptionContext1 c)\r\n   위치: System.Data.Entity.Infrastructure.Interception.InternalDispatcher1.Dispatch[TTarget,TInterceptionContext,TResult](TTarget target, Func3 operation, TInterceptionContext interceptionContext, Action3 executing, Action3 executed)\r\n   위치: System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.Reader(DbCommand command, DbCommandInterceptionContext interceptionContext)\r\n   위치: System.Data.Entity.Internal.InterceptableDbCommand.ExecuteDbDataReader(CommandBehavior behavior)\r\n   위치: System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)\r\n   위치: System.Data.Entity.Core.Mapping.Update.Internal.DynamicUpdateCommand.Execute(Dictionary2 identifierValues, List1 generatedValues)\r\n   위치: System.Data.Entity.Core.Mapping.Update.Internal.UpdateTranslator.Update()"}}}

### Range
RangeAttribute
이 속성은 database에 영향을 주지는 않지만 Validation에 영향을 줍니다.

### Enum type